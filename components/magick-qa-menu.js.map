{"version":3,"file":"magick-qa-menu.js","sourceRoot":"","sources":["../src/components/magick-qa-menu.ts"],"names":[],"mappings":";;;;;;AAAA,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG,EAAE,MAAM,KAAK,CAAC;AAC5C,OAAO,EAAE,aAAa,EAAE,QAAQ,EAAE,KAAK,EAAE,MAAM,mBAAmB,CAAC;AACnE,OAAO,+BAA+B,CAAC;AAGhC,IAAM,YAAY,GAAlB,MAAM,YAAa,SAAQ,UAAU;IAArC;;QACuB,cAAS,GAAW,OAAO,CAAC,CAAC,kCAAkC;QAClF,eAAU,GAAG,KAAK,CAAC,CAAC,uBAAuB;QAC3C,WAAM,GAAG,CAAC,CAAC,CAAC,uCAAuC;QACnD,cAAS,GAAG,CAAC,CAAC,CAAC,sBAAsB;QAmH9C,4EAA4E;QAC5E,WAAM,GAAG,CAAC,KAA8B,EAAE,EAAE;YAC1C,IAAI,CAAC,IAAI,CAAC,UAAU;gBAAE,OAAO;YAC7B,IAAI,MAAM,CAAC,UAAU,GAAG,GAAG;gBAAE,OAAO;YAEpC,MAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAC/C,MAAM,OAAO,GAAG,OAAO;gBACrB,CAAC,CAAE,KAAoB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO;gBAC1C,CAAC,CAAE,KAAoB,CAAC,OAAO,CAAC;YAElC,yCAAyC;YACzC,IAAI,CAAC,SAAS,GAAG,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC;YAEvC,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,EAAE,aAAa,CAC9C,2BAA2B,CACb,CAAC;YAEjB,iFAAiF;YACjF,MAAM,YAAY,GAAG,IAAI,CAAC,GAAG,CAC3B,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM,CAAC,UAAU,CAAC,EAAE,mCAAmC;YAChF,CAAC,MAAM,CAAC,UAAU,CACnB,CAAC;YAEF,IAAI,IAAI,CAAC,SAAS,KAAK,OAAO,EAAE,CAAC;gBAC/B,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC,YAAY,IAAI,CAAC;gBAC7C,SAAS,CAAC,KAAK,CAAC,IAAI,GAAG,MAAM,CAAC;YAChC,CAAC;iBAAM,CAAC;gBACN,SAAS,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,YAAY,IAAI,CAAC;gBAC3C,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;YACjC,CAAC;QACH,CAAC,CAAC;QAEF,oEAAoE;QACpE,YAAO,GAAG,GAAG,EAAE;YACb,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;YACxB,IAAI,MAAM,CAAC,UAAU,GAAG,GAAG;gBAAE,OAAO;YAEpC,wCAAwC;YACxC,IAAI,CAAC,gBAAgB,EAAE,CAAC;YAExB,MAAM,aAAa,GAAG,MAAM,CAAC,UAAU,GAAG,GAAG,CAAC,CAAC,qBAAqB;YAEpE,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,aAAa,EAAE,CAAC;gBAC7C,6DAA6D;gBAC7D,IAAI,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,IAAI,CAAC,SAAS,KAAK,MAAM,EAAE,CAAC;oBACpD,IAAI,CAAC,WAAW,EAAE,CAAC;gBACrB,CAAC;qBAAM,IAAI,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,IAAI,CAAC,SAAS,KAAK,OAAO,EAAE,CAAC;oBAC5D,IAAI,CAAC,UAAU,EAAE,CAAC;gBACpB,CAAC;YACH,CAAC;iBAAM,CAAC;gBACN,2DAA2D;gBAC3D,IAAI,CAAC,cAAc,EAAE,CAAC;YACxB,CAAC;YAED,uDAAuD;YACvD,MAAM,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YACrD,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YACpD,MAAM,CAAC,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YACrD,MAAM,CAAC,mBAAmB,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QACvD,CAAC,CAAC;QA0DF,4DAA4D;QAC5D,aAAQ,GAAG,GAAG,EAAE;YACd,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,EAAE,aAAa,CAC9C,2BAA2B,CACb,CAAC;YACjB,MAAM,IAAI,GAAG,SAAS,CAAC,qBAAqB,EAAE,CAAC;YAE/C,qDAAqD;YACrD,IAAI,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC,UAAU,EAAE,CAAC;gBACnC,IAAI,CAAC,WAAW,EAAE,CAAC;YACrB,CAAC;iBAAM,IAAI,IAAI,CAAC,IAAI,GAAG,EAAE,EAAE,CAAC;gBAC1B,IAAI,CAAC,UAAU,EAAE,CAAC;YACpB,CAAC;YAED,0DAA0D;YAC1D,IAAI,MAAM,CAAC,UAAU,GAAG,GAAG,EAAE,CAAC;gBAC5B,SAAS,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAC;gBAC3B,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC;YAC9B,CAAC;QACH,CAAC,CAAC;IACJ,CAAC;IAlMU,MAAM;QACb,OAAO,IAAI,CAAA,4CAA4C,IAAI,CAAC,SAAS;;wCAEjC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE;sBACnD,IAAI,CAAC,SAAS;uBACb,IAAI,CAAC,SAAS;;;wBAGb,IAAI,CAAC,SAAS;;;;;eAKvB,CAAC;IACd,CAAC;IAEQ,YAAY;QACnB,IAAI,CAAC,cAAc,EAAE,CAAC,CAAC,0BAA0B;QACjD,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,sBAAsB;IAC1E,CAAC;IAEQ,oBAAoB;QAC3B,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,wCAAwC;QAC7F,KAAK,CAAC,oBAAoB,EAAE,CAAC;IAC/B,CAAC;IAED,SAAS;QACP,sCAAsC;QACtC,IAAI,CAAC,aAAa,CAChB,IAAI,WAAW,CAAC,YAAY,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CACjE,CAAC;IACJ,CAAC;IAED,yBAAyB;IACzB,SAAS,CAAC,KAA8B;QACtC,KAAK,CAAC,cAAc,EAAE,CAAC;QAEvB,MAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QAC/C,MAAM,OAAO,GAAG,OAAO;YACrB,CAAC,CAAE,KAAoB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO;YAC1C,CAAC,CAAE,KAAoB,CAAC,OAAO,CAAC;QAElC,iCAAiC;QACjC,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC;QACtB,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC,sBAAsB;QAC1C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QAEvB,8CAA8C;QAC9C,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAEzB,yCAAyC;QACzC,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QAClD,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QACjD,MAAM,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QAClD,MAAM,CAAC,gBAAgB,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;IACpD,CAAC;IA+DD,wCAAwC;IACxC,gBAAgB;QACd,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,EAAE,aAAa,CAC9C,2BAA2B,CACb,CAAC;QACjB,SAAS,CAAC,KAAK,CAAC,UAAU;YACxB,+CAA+C,CAAC;IACpD,CAAC;IAED,oDAAoD;IACpD,iBAAiB;QACf,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,EAAE,aAAa,CAC9C,2BAA2B,CACb,CAAC;QACjB,SAAS,CAAC,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;IACtC,CAAC;IAED,mBAAmB;IACnB,UAAU;QACR,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC;QACxB,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,EAAE,aAAa,CAC9C,2BAA2B,CACb,CAAC;QACjB,SAAS,CAAC,KAAK,CAAC,IAAI,GAAG,MAAM,CAAC,CAAC,mBAAmB;QAClD,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;IACjC,CAAC;IAED,oBAAoB;IACpB,WAAW;QACT,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC;QACzB,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,EAAE,aAAa,CAC9C,2BAA2B,CACb,CAAC;QACjB,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC,CAAC,oBAAoB;QACpD,SAAS,CAAC,KAAK,CAAC,IAAI,GAAG,MAAM,CAAC;IAChC,CAAC;IAED,gEAAgE;IAChE,cAAc;QACZ,IAAI,MAAM,CAAC,UAAU,GAAG,GAAG;YAAE,OAAO;QAEpC,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,EAAE,aAAa,CAC9C,2BAA2B,CACb,CAAC;QACjB,MAAM,IAAI,GAAG,SAAS,CAAC,qBAAqB,EAAE,CAAC;QAE/C,IAAI,IAAI,CAAC,SAAS,KAAK,MAAM,IAAI,IAAI,CAAC,IAAI,KAAK,EAAE,EAAE,CAAC;YAClD,IAAI,CAAC,UAAU,EAAE,CAAC;QACpB,CAAC;aAAM,IACL,IAAI,CAAC,SAAS,KAAK,OAAO;YAC1B,IAAI,CAAC,KAAK,KAAK,MAAM,CAAC,UAAU,GAAG,EAAE,EACrC,CAAC;YACD,IAAI,CAAC,WAAW,EAAE,CAAC;QACrB,CAAC;IACH,CAAC;;AApOe,mBAAM,GAAG,GAAG,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAsD3B,AAtDqB,CAsDpB;AA3D0B;IAA3B,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;+CAA6B;AAC/C;IAAR,KAAK,EAAE;gDAAoB;AACnB;IAAR,KAAK,EAAE;4CAAY;AACX;IAAR,KAAK,EAAE;+CAAe;AAJZ,YAAY;IADxB,aAAa,CAAC,gBAAgB,CAAC;GACnB,YAAY,CAgQxB","sourcesContent":["import { LitElement, html, css } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators.js\";\nimport \"./magick-qa-menu-threads-card\";\n\n@customElement(\"magick-qa-menu\")\nexport class MagickQAMenu extends LitElement {\n  @property({ type: String }) alignment: string = \"right\"; // Track alignment (left or right)\n  @state() isDragging = false; // Track dragging state\n  @state() startX = 0; // Track initial X position during drag\n  @state() dragDelta = 0; // Track drag distance\n\n  static override styles = css`\n    .magick-qa-menu-container {\n      position: fixed;\n      height: 100vh;\n      width: auto; /* Full width for smaller screens */\n      background-color: black;\n      padding: 8px;\n      color: white;\n      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n      text-align: center;\n      z-index: 999998;\n      top: 0;\n      left: 0;\n      right: 0;\n      transition: none; /* Disable transition by default (no lag when dragging) */\n    }\n\n    .magick-qa-menu-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 8px;\n    }\n\n    /* Default behavior for large screens */\n    @media (min-width: 768px) {\n      .magick-qa-menu-container {\n        contain: layout paint;\n        max-height: calc(100vh - 50px);\n        top: 20px;\n        bottom: 20px;\n        width: 416px;\n        padding: 8px;\n        border-radius: 20px;\n        transition: none; /* Disable during drag to avoid lag */\n      }\n\n      /* Aligned to the right */\n      .right {\n        right: 25px; /* Snap to 25px instead of 0px */\n        left: auto;\n      }\n\n      /* Aligned to the left */\n      .left {\n        left: 25px; /* Snap to 25px instead of 0px */\n        right: auto;\n      }\n\n      /* Add a grabbing cursor while dragging */\n      .dragging {\n        cursor: grabbing;\n      }\n    }\n  `;\n\n  override render() {\n    return html`<section class=\"magick-qa-menu-container ${this.alignment}\">\n      <div\n        class=\"magick-qa-menu-header  ${this.isDragging ? \"dragging\" : \"\"}\"\n        @mousedown=\"${this.startDrag}\"\n        @touchstart=\"${this.startDrag}\"\n      >\n        <span>Branch</span>\n        <span @click=\"${this.closeMenu}\">X</span>\n      </div>\n      <div>\n        <magick-qa-menu-threads-card></magick-qa-menu-threads-card>\n      </div>\n    </section>`;\n  }\n\n  override firstUpdated() {\n    this.checkAlignment(); // Initial alignment check\n    window.addEventListener(\"resize\", this.onResize); // Add resize listener\n  }\n\n  override disconnectedCallback() {\n    window.removeEventListener(\"resize\", this.onResize); // Clean up event listener on disconnect\n    super.disconnectedCallback();\n  }\n\n  closeMenu() {\n    // Emit custom event to close the menu\n    this.dispatchEvent(\n      new CustomEvent(\"close-menu\", { bubbles: true, composed: true })\n    );\n  }\n\n  // Start the drag process\n  startDrag(event: MouseEvent | TouchEvent) {\n    event.preventDefault();\n\n    const isTouch = event.type.startsWith(\"touch\");\n    const clientX = isTouch\n      ? (event as TouchEvent).touches[0].clientX\n      : (event as MouseEvent).clientX;\n\n    // Record the starting X position\n    this.startX = clientX;\n    this.dragDelta = 0; // Reset drag distance\n    this.isDragging = true;\n\n    // Disable transition during drag to avoid lag\n    this.disableTransition();\n\n    // Add mouse/touch move and end listeners\n    window.addEventListener(\"mousemove\", this.doDrag);\n    window.addEventListener(\"mouseup\", this.endDrag);\n    window.addEventListener(\"touchmove\", this.doDrag);\n    window.addEventListener(\"touchend\", this.endDrag);\n  }\n\n  // Update the horizontal position while dragging and track the drag distance\n  doDrag = (event: MouseEvent | TouchEvent) => {\n    if (!this.isDragging) return;\n    if (window.innerWidth < 768) return;\n\n    const isTouch = event.type.startsWith(\"touch\");\n    const clientX = isTouch\n      ? (event as TouchEvent).touches[0].clientX\n      : (event as MouseEvent).clientX;\n\n    // Calculate the horizontal drag distance\n    this.dragDelta = clientX - this.startX;\n\n    const container = this.shadowRoot?.querySelector(\n      \".magick-qa-menu-container\"\n    ) as HTMLElement;\n\n    // Move the container horizontally based on drag, but restrict it to the viewport\n    const moveDistance = Math.max(\n      Math.min(this.dragDelta, window.innerWidth), // Limit to the width of the screen\n      -window.innerWidth\n    );\n\n    if (this.alignment === \"right\") {\n      container.style.right = `${-moveDistance}px`;\n      container.style.left = \"auto\";\n    } else {\n      container.style.left = `${moveDistance}px`;\n      container.style.right = \"auto\";\n    }\n  };\n\n  // End the drag and snap to left or right based on 40% drag movement\n  endDrag = () => {\n    this.isDragging = false;\n    if (window.innerWidth < 768) return;\n\n    // Enable transition for smooth movement\n    this.enableTransition();\n\n    const dragThreshold = window.innerWidth * 0.4; // 40% drag threshold\n\n    if (Math.abs(this.dragDelta) > dragThreshold) {\n      // If dragged more than 40% of the screen width, switch sides\n      if (this.dragDelta > 0 && this.alignment === \"left\") {\n        this.snapToRight();\n      } else if (this.dragDelta < 0 && this.alignment === \"right\") {\n        this.snapToLeft();\n      }\n    } else {\n      // Snap back to the original side if not dragged far enough\n      this.checkAlignment();\n    }\n\n    // Remove the event listeners for mousemove and mouseup\n    window.removeEventListener(\"mousemove\", this.doDrag);\n    window.removeEventListener(\"mouseup\", this.endDrag);\n    window.removeEventListener(\"touchmove\", this.doDrag);\n    window.removeEventListener(\"touchend\", this.endDrag);\n  };\n\n  // Enable smooth transition for snapping\n  enableTransition() {\n    const container = this.shadowRoot?.querySelector(\n      \".magick-qa-menu-container\"\n    ) as HTMLElement;\n    container.style.transition =\n      \"left 0.6s ease-in-out, right 0.6s ease-in-out\";\n  }\n\n  // Disable transition during drag for responsiveness\n  disableTransition() {\n    const container = this.shadowRoot?.querySelector(\n      \".magick-qa-menu-container\"\n    ) as HTMLElement;\n    container.style.transition = \"none\";\n  }\n\n  // Snap to the left\n  snapToLeft() {\n    this.alignment = \"left\";\n    const container = this.shadowRoot?.querySelector(\n      \".magick-qa-menu-container\"\n    ) as HTMLElement;\n    container.style.left = \"25px\"; // Set left to 25px\n    container.style.right = \"auto\";\n  }\n\n  // Snap to the right\n  snapToRight() {\n    this.alignment = \"right\";\n    const container = this.shadowRoot?.querySelector(\n      \".magick-qa-menu-container\"\n    ) as HTMLElement;\n    container.style.right = \"25px\"; // Set right to 25px\n    container.style.left = \"auto\";\n  }\n\n  // Check the alignment and snap to the correct side if necessary\n  checkAlignment() {\n    if (window.innerWidth < 768) return;\n\n    const container = this.shadowRoot?.querySelector(\n      \".magick-qa-menu-container\"\n    ) as HTMLElement;\n    const rect = container.getBoundingClientRect();\n\n    if (this.alignment === \"left\" && rect.left !== 25) {\n      this.snapToLeft();\n    } else if (\n      this.alignment === \"right\" &&\n      rect.right !== window.innerWidth - 25\n    ) {\n      this.snapToRight();\n    }\n  }\n\n  // Handle viewport resize to ensure the box doesn't get lost\n  onResize = () => {\n    const container = this.shadowRoot?.querySelector(\n      \".magick-qa-menu-container\"\n    ) as HTMLElement;\n    const rect = container.getBoundingClientRect();\n\n    // Ensure the container remains in view during resize\n    if (rect.right > window.innerWidth) {\n      this.snapToRight();\n    } else if (rect.left < 25) {\n      this.snapToLeft();\n    }\n\n    // For viewports < 768px, ensure the container is centered\n    if (window.innerWidth < 768) {\n      container.style.left = \"0\";\n      container.style.right = \"0\";\n    }\n  };\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"magick-qa-menu\": MagickQAMenu;\n  }\n}\n"]}